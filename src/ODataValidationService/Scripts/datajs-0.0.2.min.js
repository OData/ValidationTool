// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See License.txt in the project root for license information.

(function(e,b){if(!e.OData)e.OData={};var c=e.OData,vb=function(a,c,d){if(!a.method)a.method="GET";if(!a.headers)a.headers={};if(a.headers.Accept===b)a.headers.Accept=c.accept;a.data&&a.body===b&&c.write(a,d)},Ic=function(a,g,c,f,d,e){d.request(a,function(d){try{d.data===b&&f.read(d,e);g(d.data,d)}catch(h){if(h.request===b)h.request=a;if(h.response===b)h.response=d;c(h)}},c)},d={feed:"feed",entry:"entry",svcDoc:"service document",complexType:"complex",primitiveType:"primitive",batch:"batch",unknown:"unknown",none:"none"},h={complex:"complex",deferred:"deferred",inline:"inline",primitive:"primitive",none:"none"},cd=function(b,d){var a,c;for(a=0,c=b.length;a<c;a++)if(b[a]===d)return true;return false},mb=function(a){return a.__edmType==="Edm.DateTimeOffset"||!a.__edmType&&a.__offset},J=function(a){var f=mb(a),d=gb(a.__offset);if(f&&d!=="Z"){a=new Date(a.valueOf());var c=yb(d),i=a.getUTCHours()+c.d*c.h,h=a.getMinutes()+c.d*c.m;a.setUTCHours(i,h)}else if(!f)d="";var e=a.getUTCFullYear(),j=a.getUTCMonth()+1,g="";if(e<=0){e=-(e-1);g="-"}var b=a.getUTCMilliseconds();if(b===0)b="";else b="."+l(b.toString(),3);return g+l(e,4)+"-"+l(j,2)+"-"+l(a.getUTCDate(),2)+"T"+l(a.getUTCHours(),2)+":"+l(a.getUTCMinutes(),2)+":"+l(a.getUTCSeconds(),2)+b+d},l=function(b,c){var a=b.toString(10);while(a.length<c)a="0"+a;return a},gb=function(a){return!a||a==="Z"||a==="+00:00"||a==="-00:00"?"Z":a},m=function(a){return Object.prototype.toString.call(a)==="[object Array]"},Mb=function(a){return Object.prototype.toString.call(a)==="[object Date]"},ib=function(d,a,e){if(!d||!a)return null;if(m(a)){var b,f,c;for(b=0,f=a.length;b<f;b++){c=L(d,a[b],e);if(c)return c}}else return L(d,a,e)},kb=function(b,a){return ib(b,a,"complexType")},s=function(b,a){return ib(b,a,"entityType")},L=function(d,b,i){if(!b)return null;var a,e;if(b.dataServices){var g,f;g=b.dataServices.schema;for(a=0,e=g.length;a<e;a++){f=L(d,g[a],i);if(f)return f}}else{var h=b["namespace"];if(d.indexOf(h)!==0)return null;if(d.charAt(h.length)!==".")return null;var j=d.substr(h.length+1),c=b[i];if(c)for(a=0,e=c.length;a<e;a++)if(c[a].name===j)return c[a]}return null},yb=function(a){var b=a.substring(0,1);b=b==="+"?1:-1;var d=parseInt(a.substring(1),10),c=parseInt(a.substring(a.indexOf(":")+1),10);return{d:b,h:d,m:c}},u=function(a){switch(typeof a){case"object":return!a?d.none:m(a)||m(a.results)?d.feed:a.__metadata&&a.__metadata.uri!==b?d.entry:m(a.EntitySets)?d.svcDoc:m(a.__batchRequests)?d.batch:Mb(a)?d.primitiveType:d.complexType;case"string":case"number":case"boolean":return d.primitiveType;default:return d.unknown}},Gc=function(a){switch(u(a)){case d.complexType:return a.__deferred&&a.__deferred.uri?h.deferred:h.complex;case d.feed:case d.entry:return h.inline;case d.primitiveType:return h.primitive;default:return h.none}},A=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},F=0,Sc=function(a){return a.method&&a.method!=="GET"?false:true},Jc=function(a){return a.indexOf("http://")===0||a.indexOf("https://")===0||a.indexOf("file://")===0},Wc=function(a){if(!Jc(a))return true;var b=e.location.protocol+"//"+e.location.host+"/";return a.indexOf(b)===0?true:false},Hc=function(c,a){try{delete e[a]}catch(d){e[a]=b;if(c===F-1)F-=1}},nc=function(f,e){var b=f.getAllResponseHeaders().split(/\r?\n/),a,d;for(a=0,d=b.length;a<d;a++)if(b[a]){var c=b[a].split(": ");e[c[0]]=c[1]}};c.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:false,request:function(c,i,h){var k={},a=null,o=false;k.abort=function(){if(!a)return;o=true;a.abort();a=null;h({message:"Request aborted"})};var d,b=c.requestUri;if(!this.enableJsonpCallback||Wc(b)){a=new XMLHttpRequest;a.onreadystatechange=function(){if(a===null||a.readyState!==4)return;var e=a.statusText,d=a.status;if(d===1223){d=204;e="No Content"}var g=[];nc(a,g);var f={requestUri:b,statusCode:d,statusText:e,headers:g,body:a.responseText};a=null;if(d>=200&&d<=299)i(f);else h({message:"HTTP request failed",request:c,response:f})};a.open(c.method||"GET",b,true);if(c.headers)for(d in c.headers)a.setRequestHeader(d,c.headers[d]);if(c.timeoutMS){a.timeout=c.timeoutMS;a.ontimeout=function(){if(a){a=null;h({message:"Request timed out"})}}}a.send(c.body)}else{if(!Sc(c))throw{message:"Request is not local and cannot be done through JSONP."};var m=F;F+=1;var n=m.toString();d="handleJSONP_"+n;e[d]=function(a){Hc(d,m);i({body:a,statusCode:200,headers:{"Content-Type":"application/json"}})};var g=document.createElement("SCRIPT");g.setAttribute("type","text/javascript");var f=this.callbackParameterName+"="+d;if(this.formatQueryString)f+="&"+this.formatQueryString;var j=b.indexOf("?");if(j===-1)b=b+"?"+f;else if(j===b.length-1)b=b+f;else b=b+"&"+f;g.setAttribute("src",b);var l=document.getElementsByTagName("HEAD")[0];l.appendChild(g);l=g=null}return k}};var v=function(f){if(!f)return null;var b=f.split(";"),d={},a,e;for(a=1,e=b.length;a<e;a++){var c=b[a].split("=");d[A(c[0])]=c[1]}return{mediaType:A(b[0]),properties:d}},lc=function(a){if(!a)return b;var d=a.mediaType,c;for(c in a.properties)d+=";"+c+"="+a.properties[c];return d},cb=function(b,a,c,d){return{contentType:b,dataServiceVersion:a,metadata:c,handler:d}},lb=function(b,c,d){if(!b)return;var a=b.headers;if(!a[c])a[c]=d},cc=function(a,b){if(!a.dataServiceVersion)a.dataServiceVersion=b},W=function(c,d){var a=c.headers;return a&&a[d]||b},tb=function(a){return v(W(a,"Content-Type"))},fb=function(a){return W(a,"DataServiceVersion")},ub=function(a,b){return a.accept.indexOf(b.mediaType)>=0},Tc=function(c,h,a,f){if(!a||!a.headers)return false;var g=tb(a),i=fb(a)||"",d=a.body;if(d===b||d===null)return false;if(ub(c,g)){var e=cb(g,i,f?f.metadata:null,c);e.response=a;a.data=h(c,d,e);return a.data&&true}return false},Mc=function(c,f,a,e){if(!a||!a.headers)return false;var d=tb(a),g=fb(a);if(!d||ub(c,d)){var b=cb(d,g,e?e.metadata:null,c);b.request=a;a.body=f(c,a.data,b);if(a.body){lb(a,"DataServiceVersion",b.dataServiceVersion||"1.0");lb(a,"Content-Type",lc(b.contentType));return true}}return false},C=function(c,b,d,a){return{accept:d,maxDataServiceVersion:a,read:function(a,b){return Tc(this,c,a,b)},write:function(c,a){return Mc(this,b,c,a)}}},Qc="application/xml",ed=/^([^:/?#]+:)?(\/\/[^/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,Ob="http://",G=Ob+"www.w3.org/",x=Ob+"schemas.microsoft.com/ado/",E=x+"2007/08/dataservices",R=G+"2000/xmlns/",Nb=G+"XML/1998/namespace",Lb=x+"2007/06/edmx",hd=x+"2008/09/edm",fd=x+"2006/04/edm",gd=x+"2007/05/edm",f=G+"2005/Atom",w=G+"2007/app",n=E,g=E+"/metadata",M=E+"/related/",Eb=E+"/scheme",Db=["scheme","authority","path","query","fragment"],Hb=function(e){var b={isAbsolute:false};if(e){var c=ed.exec(e);if(c){var a,d;for(a=0,d=Db.length;a<d;a++)if(c[a+1])b[Db[a]]=c[a+1]}if(b.scheme)b.isAbsolute=true}return b},k=function(d,e){if(!e)return d;var b=Hb(d);if(b.isAbsolute)return d;var c=Hb(e),a={};if(b.authority){a.authority=b.authority;a.path=b.path;a.query=b.query}else{if(!b.path){a.path=c.path;a.query=b.query||c.query}else{if(b.path.charAt(0)==="/")a.path=b.path;else a.path=ic(b,c);a.query=b.query}a.authority=c.authority}a.scheme=c.scheme;a.fragment=b.fragment;return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")},ic=function(c,b){var a="/";if(b.path){var d=b.path.lastIndexOf("/");a=b.path.substring(0,d);if(a.charAt(a.length-1)!=="/")a=a+"/"}return a+c.path},Rb=function(a){var b=/(^\s)|(\s$)/;return b.test(a)},a={addNamespaceAttribute:function(c,d,e){var b=c.ownerDocument,a;if(b.createAttributeNS)a=b.createAttributeNS(R,d);else a=b.createNode(2,d,R);a.nodeValue=e;c.setAttributeNode(a)},appendAsXml:function(c,d){var g="<container>"+d+"</container>",f=a.parse(g,null),e=c.ownerDocument.importNode(f.domNode,true),b=e.firstChild;while(b){c.appendChild(b);b=b.nextSibling}},appendPreserving:function(a,b){Rb(b)&&a.setAttribute("xml:space","preserve");var c=a.ownerDocument.createTextNode(b);a.appendChild(c)},attributes:function(f,e){var b,c=f.domNode,a,d;for(a=0,d=c.attributes.length;a<d;a++){b=c.attributes.item(a);e(this._wrapNode(b))}},attribute:function(b,a,c){return this._attribute(b.domNode,a,c)},attributeNode:function(d,b,c){var a=d.attributes;return a.getNamedItemNS?a.getNamedItemNS(c,b):a.getQualifiedItem(b,c)},childElements:function(c,d){var a=c.domNode.firstChild,b;while(a!==null){if(a.nodeType===1){b=k(this._baseURI(a),c.baseURI);d(this._wrapNode(a,b))}a=a.nextSibling}},firstDomElementChild:function(b){var a=b.firstChild;while(a){if(a.nodeType===1)break;a=a.nextSibling}return a},firstElement:function(c){var a=c.domNode.firstChild,b;while(a!==null){if(a.nodeType===1){b=k(this._baseURI(a),c.baseURI);return this._wrapNode(a,b)}a=a.nextSibling}return null},getSingleElementByTagNameNS:function(c,e,f){var d;if(c.getElementsByTagNameNS){d=c.getElementsByTagNameNS(e,f);if(d.length!==0)return d[0]}else{var b=c.firstChild;while(b){if(b.nodeType===1&&a.localName(b)===f&&b.namespaceURI===e)return b;b=b.nextSibling}}return null},innerText:function(e){var c=e.text;if(c!==b)return c;c="";var a=e.firstChild;if(a)do{if(a.nodeType===3||a.nodeType===4)c+=a.nodeValue;var d=a.firstChild;if(!d)while(a!==e){d=a.nextSibling;if(d){a=d;break}else a=a.parentNode}else a=d}while(a!==e);return c},localName:function(a){return a.localName?a.localName:a.baseName},newDocument:function(c,b){var a;if(e.ActiveXObject){a=new ActiveXObject("Msxml2.DOMDocument.6.0");a.async=false;a.documentElement=a.createNode(1,c,b)}else if(e.document.implementation&&e.document.implementation.createDocument)a=e.document.implementation.createDocument(b,c,null);var d=a.createProcessingInstruction("xml","version='1.0' encoding='utf-8'");a.insertBefore(d,a.documentElement);return this._wrapNode(a.documentElement)},newDomAttribute:function(d,c,g,f){var e=d.ownerDocument,a;c=f?f+":"+c:c;if(e.createAttributeNS){a=e.createAttributeNS(g,c);d.setAttributeNodeNS(a)}else{a=e.createNode(2,c,g||b);d.setAttributeNode(a)}return a},newDomElement:function(f,a,g,e){var d=f.ownerDocument,c;a=e?e+":"+a:a;if(d.createElementNS)c=d.createElementNS(g,a);else c=d.createNode(1,a,g||b);f.appendChild(c);return c},newElement:function(d,g,e,f){var c=d.domNode.ownerDocument,a;if(c.createElementNS)a=c.createElementNS(e,g);else a=c.createNode(1,g,e||b);f&&this.appendPreserving(a,f);d.domNode.appendChild(a);return this._wrapNode(a)},newAttribute:function(c,g,e,f){var d=c.domNode.ownerDocument,a;if(d.createAttributeNS){a=d.createAttributeNS(e,g);a.value=f;c.domNode.setAttributeNodeNS(a)}else{a=d.createNode(2,g,e||b);a.value=f;c.domNode.setAttributeNode(a)}return this._wrapNode(a)},qualifyXmlTagName:function(b,a){return a?a+":"+b:b},parse:function(d,c){var a=this._parse(d),b=k(this._baseURI(a),c);return this._wrapNode(a,b)},serialize:function(a){var b=a.domNode.ownerDocument;return this.serializeNode(b)},serializeChildren:function(f){var d=f.childNodes,a,h=d.length;if(h===0)return"";var c=f.ownerDocument.createDocumentFragment();for(a=0;a<h;a++)c.appendChild(d[a].cloneNode(true));var g=c.xml;if(g!==b)return g;else{var i=new e.XMLSerializer;return i.serializeToString(c)}},serializeNode:function(a){var c=a.xml;if(c!==b)return c;if(e.XMLSerializer){var d=new e.XMLSerializer;return d.serializeToString(a)}throw{message:"XML serialization unsupported"};},_attribute:function(a,b,c){if(a.getAttributeNS)return a.getAttributeNS(c||null,b);var d=a.attributes.getQualifiedItem(b,c);return d?d.value:null},_baseURI:function(a){return this._attribute(a,"base",Nb)},_parse:function(b){var a;if(e.ActiveXObject){a=new ActiveXObject("Msxml2.DOMDocument.6.0");a.async=false;a.loadXML(b);if(a.parseError.errorCode!==0)throw{message:a.parseError.reason,errorXmlText:b,srcText:a.parseError.srcText};}else{var c=new e.DOMParser;a=c.parseFromString(b,"text/xml")}return a.documentElement},_wrapNode:function(a,b){return{baseURI:b,domNode:a,localName:this.localName(a),nsURI:a.namespaceURI||null}}};c.xml=a;var pb=["application/atom+xml","application/atomsvc+xml","application/xml"],xb=pb[0],ad=a.qualifyXmlTagName("inline","m"),Lc=a.qualifyXmlTagName("properties","m"),fc=a.qualifyXmlTagName("type","m"),ec=a.qualifyXmlTagName("null","m"),dc=[f,w,Nb,R],Xb={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},z=function(a){return!cd(dc,a)},o=function(a){return a},bd=function(a){return a==="true"},zc=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(.*)$/,Y=function(l,g){var a=zc.exec(l),d=a?gb(a[8]):null;if(!a||!g&&d!=="Z")throw{message:"Invalid date/time value"};var f=parseInt(a[1],10);if(f<=0)f++;var b=a[7];if(!b)b=0;else{if(b.length>4)throw{message:"Cannot parse date/time value to given precision."};while(b.length<4)b+="0";b=parseInt(b.substring(1),10)}var j=parseInt(a[4],10),i=parseInt(a[5],10),k=parseInt(a[6],10);if(d!=="Z"){var e=yb(d),h=-e.d;j+=e.h*h;i+=e.m*h}var c=new Date;c.setUTCFullYear(f,parseInt(a[2],10)-1,parseInt(a[3],10));c.setUTCHours(j,i,k,b);if(isNaN(c.valueOf()))throw{message:"Invalid date/time value"};if(g){c.__edmType="Edm.DateTimeOffset";c.__offset=d}return c},Kc=function(a){return Y(a,false)},mc=function(a){return Y(a,true)},Ib=function(){throw{message:"Edm.Time not supported"};},db={"Edm.Boolean":bd,"Edm.Binary":o,"Edm.DateTime":Kc,"Edm.DateTimeOffset":mc,"Edm.Time":Ib,"Edm.Decimal":o,"Edm.Guid":o,"Edm.String":o,"Edm.Byte":parseInt,"Edm.Double":parseFloat,"Edm.Single":parseFloat,"Edm.Int16":parseInt,"Edm.Int32":parseInt,"Edm.Int64":o,"Edm.SByte":parseInt},i=function(a){return a.toString()},Vc=Ib,Zb={"Edm.Binary":i,"Edm.Boolean":i,"Edm.Byte":i,"Edm.DateTime":J,"Edm.DateTimeOffset":J,"Edm.Decimal":i,"Edm.Double":i,"Edm.Guid":i,"Edm.Int16":i,"Edm.Int32":i,"Edm.Int64":i,"Edm.SByte":i,"Edm.Single":i,"Edm.String":i,"Edm.Time":Vc},N=function(a){return a&&db[a]!==b},V=function(a,b){if(a!==null&&b){var c=db[b];if(c)a=c(a)}return a},X=function(a,b){if(a!==null&&b){if(Mb(a))b=mb(a)?"Edm.DateTimeOffset":"Edm.DateTime";var c=Zb[b];if(c)a=c(a)}return a},nb=function(a,b){if(a.nsURI===f)switch(a.localName){case"feed":return Nc(a,b);case"entry":return zb(a,b)}if(a.nsURI===w&&a.localName==="service")return Yb(a);throw{message:"Invalid AtomPub document: root element can only be feed, entry, or service",element:a};},Nc=function(c,d){var b={results:[],__metadata:{}};b.__metadata.feed_extensions=p(c);a.childElements(c,function(c){switch(c.nsURI){case f:switch(c.localName){case"id":b.__metadata.uri=k(a.innerText(c.domNode),c.baseURI);b.__metadata.uri_extensions=p(c);break;case"title":b.__metadata.title=a.innerText(c.domNode);b.__metadata.title_extensions=p(c);break;case"entry":var h=zb(c,d);b.results.push(h);break;case"link":vc(c,b)}return;case g:if(c.localName==="count"){b.__count=parseInt(a.innerText(c.domNode));return}}var e=r(c);b.__metadata.feed_extensions.push(e)});return b},vc=function(c,b){var a=Cb(c);switch(a.rel){case"next":b.__next=a.href;b.__metadata.next_extensions=a.extensions;break;case"self":b.__metadata.self=a.href;b.__metadata.self_extensions=a.extensions}},Cb=function(c){var b={extensions:[]},d;a.attributes(c,function(a){if(!a.nsURI)switch(a.localName){case"href":b.href=k(a.domNode.nodeValue,c.baseURI);return;case"type":case"rel":b[a.localName]=a.domNode.nodeValue;return}if(z(a.nsURI)){d=q(a);b.extensions.push(d)}});if(!b.href)throw{error:"href attribute missing on link element",element:c};return b},r=function(b){var c={name:b.localName,namespaceURI:b.nsURI,attributes:p(b),children:[]};a.childElements(b,function(b){var a=r(b);c.children.push(a)});if(c.children.length===0){var d=a.innerText(b.domNode);if(d)c.value=d}return c},p=function(c){var b=[];a.attributes(c,function(a){if(z(a.nsURI)){var c=q(a);b.push(c)}});return b},q=function(a){return{name:a.localName,namespaceURI:a.nsURI,value:a.domNode.nodeValue}},hb=function(d,a){if(d.indexOf("/")===-1)return a[d];else{var e=d.split("/"),c,f;for(c=0,f=e.length;c<f;c++){if(a===null)return b;a=a[e[c]];if(a===b)return a}return a}},kc=function(g,a,k,h){var d;if(g.indexOf("/")===-1){a[g]=k;d=g}else{var f=g.split("/"),c,l;for(c=0,l=f.length-1;c<l;c++){var e=a[f[c]];if(e===b){e={};a[f[c]]=e}else if(e===null)return;a=e}d=f[c];a[d]=k}if(h){var j=a.__metadata=a.__metadata||{},i=j.properties=j.properties||{},m=i[d]=i[d]||{};m.type=h}},bb=function(a){return Xb[a]||a},xc=function(g,i,c,h){var e=i.split("/"),d,f;for(d=0,f=e.length;d<f;d++)if(e[d][0]==="@")return a._attribute(c,e[d].substring(1),g);else{c=a.getSingleElementByTagNameNS(c,g,e[d]);if(!c)return b}return h?a.serializeChildren(c):a.innerText(c)},Ac=function(f,h,l,k,j,g){var b=k,e=l.split("/"),c,i;for(c=0,i=e.length;c<i;c++){var d;if(e[c][0]==="@"){d=a.attributeNode(b,e[c].substring(1),f);if(!d)d=a.newDomAttribute(b,e[c].substring(1),f,h)}else{d=a.getSingleElementByTagNameNS(b,f,e[c]);if(!d)d=a.newDomElement(b,e[c],f,h)}b=d}if(b.nodeType===2)b.value=g;else if(j){b.setAttribute("type","xhtml");a.appendAsXml(b,g)}else a.appendPreserving(b,g)},Dc=function(d){if(d.childNodes.length)return false;var c=d.attributes,e=c.length;if(e===0)return true;for(var a=0;a<e;a++){var b=c[a].nodeName;if(b!=="xmlns"&&b.indexOf("xmlns:")!==0)return false}return true},tc=function(k,o){var c=a.getSingleElementByTagNameNS(k.domNode,g,"properties");if(!c){var j=a.getSingleElementByTagNameNS(k.domNode,f,"content");if(j)c=a.getSingleElementByTagNameNS(j,g,"properties")}if(c){var b=c,h=o.split("/"),e,m;for(e=0,m=h.length-1;e<m;e++){b=a.getSingleElementByTagNameNS(b,n,h[e]);if(!b)return}var i=a.getSingleElementByTagNameNS(b,n,h[e]);i&&b.removeChild(i);var d=b;while(d!==c&&Dc(d)){var l=d.parentNode;l.removeChild(d);d=l}}},U=function(a,g,e,n,k,c,o){var h=a["FC_TargetPath"+c],i=bb(h),m=h!==i?f:a["FC_NsUri"+c],j=a["FC_KeepInContent"+c]==="true"?true:false,l=a["FC_ContentKind"+c]==="xhtml",p=a["FC_NsPrefix"+c]||null,d=hb(g,n);if(d===null||d===b)return;if(!j){cc(o,"2.0");tc(e,g)}d=X(d,k);Ac(m,p,i,e.domNode,l,d)},T=function(a,h,k,g,e,c){if(a["FC_KeepInContent"+c]==="true")return;if(hb(h,g)===null)return;var i=a["FC_TargetPath"+c],j=bb(i),l=i!==j?f:a["FC_NsUri"+c],m=a["FC_ContentKind"+c]==="xhtml",d=xc(l,j,k.domNode,m);if(d===b)return;d=V(d,e);kc(h,g,d,e)},K=function(h,c,l){var j=l.split("/"),e,k;while(c){var f=c;for(e=0,k=j.length;e<k;e++){var d=f.property;if(!d)break;var a,g,i=false;for(a=0,g=d.length;a<g;a++)if(d[a].name===j[e]){i=true;break}if(!i)break;var b=d[a].type;if(!b||N(b))return b||null;f=kb(b,h);if(!f)return null}c=s(c.baseType,h)}return null},bc=function(l,h,d){if(!d||d.length===0)return;var j=h.__metadata.type;while(j){var a=s(j,d);if(!a)return;var c,b=a.FC_SourcePath;if(b){c=K(d,a,b);T(a,b,l,h,c,"")}var i=a.property;if(i){var g,n;for(g=0,n=i.length;g<n;g++){var e=i[g],k=0,f="";while(e["FC_TargetPath"+f]){b=e.name;c=e.type;var m=e["FC_SourcePath"+f];if(m){b+="/"+m;c=K(d,a,b)}T(e,b,l,h,c,f);k++;f="_"+k}}}j=a.baseType}},zb=function(c,d){var b={__metadata:{}},e=a.attribute(c,"etag",g);if(e)b.__metadata.etag=e;a.childElements(c,function(c){if(c.nsURI===f)switch(c.localName){case"id":b.__metadata.uri=k(a.innerText(c.domNode),c.baseURI);b.__metadata.uri_extensions=p(c);break;case"category":sc(c,b);break;case"content":jc(c,b);break;case"link":rc(c,b,d)}c.nsURI===g&&c.localName==="properties"&&H(c,b,b.__metadata)});bc(c,b,d);return b},sc=function(d,b){var e=a.attribute(d,"scheme"),f=a.attribute(d,"term");if(e===Eb){if(b.__metadata.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:d};b.__metadata.type=f;b.__metadata.type_extensions=[];var c;a.attributes(d,function(a){if(!a.nsURI){if(a.localName!=="scheme"&&a.localName!=="term"){c=q(a);b.__metadata.type_extensions.push(c)}}else if(z(a.nsURI)){c=q(a);b.__metadata.type_extensions.push(c)}})}},jc=function(b,c){var d=a.attribute(b,"src"),e=a.attribute(b,"type");if(d){if(!e)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:b};c.__metadata.media_src=k(d,b.baseURI);c.__metadata.content_type=e}a.childElements(b,function(a){if(d)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:b};a.nsURI===g&&a.localName==="properties"&&H(a,c,c.__metadata)})},Ub=function(b,c){c.__metadata.edit_media=b.href;c.__metadata.edit_media_extensions=[];var a,d;for(a=0,d=b.extensions.length;a<d;a++)if(b.extensions[a].namespaceURI===g&&b.extensions[a].name==="etag")c.__metadata.media_etag=b.extensions[a].value;else c.__metadata.edit_media_extensions.push(b.extensions[a])},rc=function(c,b,d){var a=Cb(c);switch(a.rel){case"self":b.__metadata.self=a.href;b.__metadata.self_link_extensions=a.extensions;break;case"edit":b.__metadata.edit=a.href;b.__metadata.edit_link_extensions=a.extensions;break;case"edit-media":Ub(a,b);break;default:a.rel.indexOf(M)===0&&Tb(c,a,b,d)}},Tb=function(h,e,d,i){var f=e.rel.substring(M.length),c=b;a.childElements(h,function(b){if(b.nsURI===g&&b.localName==="inline"){var d=a.firstElement(b);if(d)c=nb(d,i);else c=null}});if(c===b)c={__deferred:{uri:e.href}};d[f]=c;d.__metadata.properties=d.__metadata.properties||{};d.__metadata.properties[f]={extensions:e.extensions}},H=function(c,d,b){a.childElements(c,function(a){if(a.nsURI===n){b.properties=b.properties||{};gc(a,d,b.properties)}})},gc=function(c,j,i){var f=null,d="Edm.String",e=[];a.attributes(c,function(a){if(a.nsURI===g)switch(a.localName){case"null":f=a.domNode.nodeValue;return;case"type":d=a.domNode.nodeValue;return}if(z(a.nsURI)){var b=q(a);e.push(b)}});var b=null,h={type:d,extensions:e};if(f!=="true"){b=a.innerText(c.domNode);if(N(d))b=V(b,d);else if(a.firstElement(c)){b={__metadata:{type:d}};H(c,b,h)}}j[c.localName]=b;i[c.localName]=h},Yb=function(c){var b={workspaces:[],extensions:[]};a.childElements(c,function(a){if(a.nsURI===w&&a.localName==="workspace"){var e=Qb(a);b.workspaces.push(e)}else{var d=r(c);b.extensions.push(d)}});if(b.workspaces.length===0)throw{message:"Invalid AtomPub service document: No workspace element found.",element:c};return b},Qb=function(c){var b={collections:[],extensions:[]};a.childElements(c,function(d){if(d.nsURI===f){if(d.localName==="title"){if(c.title)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",element:d};b.title=a.innerText(d.domNode)}}else if(d.nsURI===w){if(d.localName==="collection"){var e=Pb(d,b);b.collections.push(e)}}else{var g=r(c);b.extensions.push(g)}});b.title=b.title||"";return b},Pb=function(c){var b={href:a.attribute(c,"href"),extensions:[]};if(!b.href)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:c};b.href=k(b.href,c.baseURI);a.childElements(c,function(d){if(d.nsURI===f){if(d.localName==="title"){if(b.title)throw{message:"Invalid AtomPub service document: collection has more than one child title element",element:d};b.title=a.innerText(d.domNode)}}else if(d.nsURI!==w){var e=r(c);b.extensions.push(e)}});if(!b.title)throw{message:"Invalid AtomPub service document: collection has no title element",element:c};return b},uc=function(b,c){var a,e=u(b);switch(e){case d.feed:a=Ab(null,b,c);break;case d.entry:case d.complexType:a=O(null,b,c);break;default:throw{message:'Serialization of payloads of type "'+e+'" is not supported'};}return a},Bb=function(c,d){if(c)return a.newElement(c,d,f);var b=a.newDocument(d,f);a.addNamespaceAttribute(b.domNode,"xmlns:d",n);a.addNamespaceAttribute(b.domNode,"xmlns:m",g);return b},Ab=function(g,c,f){var d=Bb(g,"feed"),b=m(c)?c:c.results;if(b){var a,e;for(a=0,e=b.length;a<e;a++)O(d,b[a],f)}return d},O=function(k,c,e){var b=Bb(k,"entry"),j=a.newElement(b,"author",f);a.newElement(j,"name",f);a.newElement(b,"title",f);var d=a.newElement(b,"content",f);a.newAttribute(d,"type",null,"application/xml");var i=a.newElement(d,Lc,g),h=c.__metadata?c.__metadata.properties:null;ac(b,c.__metadata);Z(b,i,c,h,e);hc(b,c,e);return b},hc=function(l,e,i){if(!e.__metadata)return;var h=i.metadata,a=s(e.__metadata.type,h);while(a){var k,c=a.FC_SourcePath;if(c){k=K(h,a,c);U(a,c,l,e,k,"",i)}var g=a.property;if(g){var f,m;for(f=0,m=g.length;f<m;f++){var b=g[f],j=0,d="";while(b["FC_TargetPath"+d]){c=b.name;if(b["FC_SourcePath"+d])c+="/"+b["FC_SourcePath"+d];U(b,c,l,e,b.type,d,i);j++;d="_"+j}}}a=s(a.baseType,h)}},ac=function(c,b){if(b){b.etag&&a.newAttribute(c,"etag",g,b.etag);b.uri&&a.newElement(c,"id",f,b.uri);if(b.type){var d=a.newElement(c,"category",f);a.newAttribute(d,"term",null,b.type);a.newAttribute(d,"scheme",null,Eb)}}},pc=function(c,d,e){var b=a.newElement(c,"link",f);a.newAttribute(b,"rel",null,e);a.newAttribute(b,"href",null,d);return b},Z=function(j,g,i,f,e){var a,c,d,b;for(a in i)if(a!=="__metadata"){c=i[a];d=Gc(c);switch(d){case h.primitive:case h.complex:b=f?f[a]:null;eb(g,a,d,c,b,e);break;case h.deferred:case h.inline:Sb(j,d,a,c,e);break;case h.none:!(b&&b[a]&&!N(b[a]))&&eb(g,a,h.primitive,c,null,e)}}},eb=function(j,m,l,e,c,k){var i=a.qualifyXmlTagName(m,"d"),d=c&&c.type,b;if(l===h.complex){b=a.newElement(j,i,n);var f;if(c)f=c.properties;Z(null,b,e,f,k)}else b=a.newElement(j,i,n,X(e,d||"Edm.String"));e===null&&a.newAttribute(b,ec,g,"true");d&&a.newAttribute(b,fc,g,d)},Sb=function(m,n,o,b,l){var f,c,e;if(n===h.inline){f=b.__metadata?b.__metadata.uri:"";e=u(b);switch(e){case d.entry:c=O;break;case d.feed:c=Ab;break;default:throw{message:"Invalid payload for inline navigation property: "+e};}}else f=b.__deferred.uri;var p=k(o,M),i=pc(m,f,p);if(c){var j=a.newElement(i,ad,g);a.newAttribute(i,"type",null,"application/atom+xml;type="+e);c(j,b,l)}},Uc=function(e,c,d){if(c){var b=a.parse(c);if(b)return nb(b,d.metadata)}},Bc=function(h,g,c){var e=c.contentType=c.contentType||v(xb),d=b;if(e&&e.mediaType===xb){var f=uc(g,c);d=a.serialize(f)}return d};c.atomHandler=C(Uc,Bc,pb.join(","),"2.0");var j={elements:{Association:{attributes:["Name"],elements:["End*","ReferentialConstraint"]},AssociationSet:{attributes:["Name","Association"],elements:["End*"]},CollectionType:{attributes:["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},ComplexType:{attributes:["Name","BaseType","Abstract"],elements:["Property*"]},DefiningExpression:{text:true},Dependent:{attributes:["Role"],elements:["PropertyRef*"]},Documentation:{text:true},End:{attributes:["Type","Role","Multiplicity","EntitySet"],elements:["OnDelete"]},EntityContainer:{attributes:["Name","Extends"],elements:["EntitySet*","AssociationSet*","FunctionImport*"]},EntitySet:{attributes:["Name","EntityType"]},EntityType:{attributes:["Name","BaseType","Abstract","OpenType"],elements:["Key","Property*","NavigationProperty*"]},Function:{attributes:["Name","ReturnType"],elements:["Parameter*","DefiningExpression","ReturnType"]},FunctionImport:{attributes:["Name","ReturnType","EntitySet"],elements:["Parameter*"]},Key:{elements:["PropertyRef*"]},NavigationProperty:{attributes:["Name","Relationship","ToRole","FromRole"]},OnDelete:{attributes:["Action"]},Parameter:{attributes:["Name","Type","Mode","MaxLength","Precision","Scale"]},Principal:{attributes:["Role"],elements:["PropertyRef*"]},Property:{attributes:["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode"]},PropertyRef:{attributes:["Name"]},ReferenceType:{attributes:["Type"]},ReferentialConstraint:{elements:["Principal","Dependent"]},ReturnType:{attributes:["ReturnType"],elements:["CollectionType","ReferenceType","RowType"]},RowType:{elements:["Property*"]},Schema:{attributes:["Namespace","Alias"],elements:["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*"]},TypeRef:{attributes:["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},Using:{attributes:["Namespace","Alias"]}}},ab=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];j.elements.Property.attributes=j.elements.Property.attributes.concat(ab);j.elements.EntityType.attributes=j.elements.EntityType.attributes.concat(ab);j.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:Lb};j.elements.DataServices={elements:["Schema*"],ns:Lb};j.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer");j.elements.Property.attributes.push("m:MimeType");j.elements.FunctionImport.attributes.push("m:HttpMethod");j.elements.EntityType.attributes.push("m:HasStream");j.elements.DataServices.attributes=["m:DataServiceVersion"];var Q=function(a){if(!a)return a;if(a.length>1){var b=a.substr(0,2);return b===b.toUpperCase()?a:a.charAt(0).toLowerCase()+a.substr(1)}return a.charAt(0).toLowerCase()},Cc=function(g,e){if(e==="Documentation")return{isArray:true,propertyName:"documentation"};var c=g.elements;if(!c)return null;var b,f;for(b=0,f=c.length;b<f;b++){var a=c[b],d=false;if(a.charAt(a.length-1)==="*"){d=true;a=a.substr(0,a.length-1)}if(e===a){var h=Q(a);return{isArray:d,propertyName:h}}}return null},I=function(b){if(!b.domNode)b=a._wrapNode(b,"");var p=b.localName,d=j.elements[p];if(!d)return null;if(d.ns){if(b.nsURI!==d.ns)return null}else if(b.nsURI!==hd&&b.nsURI!==fd&&b.nsURI!==gd)return null;var c={},k=d.attributes;if(k){var h,o;for(h=0,o=k.length;h<o;h++){var e=k[h],n=e.indexOf(":"),i="";if(n>0){i=g;e=e.substr(n+1)}var f=a.attribute(b,e,i);if(f){c[Q(e)]=f;var m=1;while(1){var l=e+"_"+m;f=a.attribute(b,l,i);if(!f)break;c[Q(l)]=f;m++}}}}a.childElements(b,function(e){var a=Cc(d,e.localName);if(a)if(a.isArray){var b=c[a.propertyName];if(!b){b=[];c[a.propertyName]=b}b.push(I(e))}else c[a.propertyName]=I(e)});if(d.text)c.text=a.innerText(b);return c},Fc=function(e,c){var d=a.parse(c);return I(d)||b};c.metadataHandler=C(Fc,null,Qc,"1.0");var P="application/json",Wb=function(d,g){var b={collections:[]},a,e;for(a=0,e=d.EntitySets.length;a<e;a++){var c=d.EntitySets[a],f={title:c,href:k(c,g)};b.collections.push(f)}return{workspaces:[b]}},Xc=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,yc=function(a){var b;if(a<0){b="-";a=-a}else b="+";var c=Math.floor(a/60);a=a-60*c;return b+l(c,2)+":"+l(a,2)},jb=function(d){var b=d&&Xc.exec(d);if(b){var a=new Date(parseInt(b[1],10));if(b[2]){var c=parseInt(b[3],10);if(b[2]==="-")c=-c;var e=a.getUTCMinutes();a.setUTCMinutes(e-c);a.__edmType="Edm.DateTimeOffset";a.__offset=yc(c)}if(!isNaN(a.valueOf()))return a}},ob=function(a,f){if(a&&typeof a==="object")for(var d in a){var e=a[d],c=ob(e,f);c=f(d,c);if(c!==e)if(e===b)delete a[d];else a[d]=c}return a},dd=function(b,a){return a("",ob(b,a))},Yc=function(f,c,b){var d=b.metadata,a=typeof c==="string"?e.JSON.parse(c):c;a=dd(a,function(l,b){if(b&&typeof b==="object"){var h=b.__metadata&&b.__metadata.type,i=s(h,d)||kb(h,d),a;if(i){var g=i.property;if(g){var e,k;for(e=0,k=g.length;e<k;e++){var c=g[e];if(c.type==="Edm.DateTime"||c.type==="Edm.DateTimeOffset"){a=b[c.name];if(a){a=jb(a);if(!a)throw{message:"Invalid date/time value"};b[c.name]=a}}}}}else if(f.recognizeDates)for(var j in b){a=b[j];if(typeof a==="string")b[j]=jb(a)||a}}return b}).d;a=Vb(a,b.dataServiceVersion);a=qc(a,b.response.requestUri);return a},Ec=function(j,g,a){var d=b,f=a.contentType=a.contentType||v(P);if(f&&f.mediaType===P){var c=a.dataServiceVersion,h=g;if(c&&c!=="1.0")h={results:[g]};var i=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return J(this)};d=e.JSON.stringify(h)}finally{Date.prototype.toJSON=i}}return d},qc=function(a,b){return u(a)===d.svcDoc?Wb(a,b):a},Vb=function(b,a){if(a&&a.lastIndexOf(";")===a.length-1)a=a.substr(0,a.length-1);if(!a)if(m(b))a="1.0";if(a==="2.0")return b;if(a==="1.0")if(m(b))b={results:b};return b};c.jsonHandler=C(Yc,Ec,P,"2.0");c.jsonHandler.recognizeDates=false;var Kb=[c.jsonHandler,c.atomHandler],rb=function(d,c,e){var a,b;for(a=0,b=Kb.length;a<b&&!Kb[a][d](c,e);a++);if(a===b)throw{message:"no handler for data"};};c.defaultSuccess=function(a){e.alert(a.toString())};c.defaultError=function(a){throw a;};c.defaultHandler={read:function(a,c){a&&a.body!==null&&a.body!==b&&(a.headers["Content-Type"]||a.headers["content-type"])&&rb("read",a,c)},write:function(b,a){rb("write",b,a)},accept:"application/atomsvc+xml;q=0.8, application/json;q=0.5, */*;q=0.1"};c.defaultMetadata=[];var t="multipart/mixed",oc=/^HTTP\/1\.\d (\d{3}) (.*)$/i,S=function(){return Math.floor((1+Math.random())*65536).toString(16).substr(1)},sb=function(a){return a+S()+"-"+S()+"-"+S()},Fb=function(a){return a.handler.partHandler},qb=function(b){var a=b.boundaries;return a[a.length-1]},Rc=function(d,c,a){var b=a.contentType.properties.boundary;return{__batchResponses:Jb(c,{boundaries:[b],handlerContext:a})}},wc=function(d,c,a){var b=a.contentType=a.contentType||v(t);if(b.mediaType===t)return Zc(c,a)},Jb=function(b,a){var f="--"+qb(a);D(b,a,f);B(b,a);var e=[],g;while(g!=="--"&&a.position<b.length){var h=Gb(b,a),d=v(h["Content-Type"]);if(d&&d.mediaType===t){a.boundaries.push(d.properties.boundary);e.push({__changeResponses:Jb(b,a)});a.boundaries.pop();D(b,a,"--"+qb(a))}else{if(!d||d.mediaType!=="application/http")throw{message:"invalid MIME part type "};var c=Oc(b,a,f);try{if(c.statusCode>=200&&c.statusCode<=299)Fb(a.handlerContext).read(c,a.handlerContext);else c={message:"HTTP request failed",response:c}}catch(i){c=i}e.push(c)}g=b.substr(a.position,2);B(b,a)}return e},Gb=function(e,d){var c={},a,b;while(b=B(e,d)){a=b.indexOf(":");if(a!==-1)c[A(b.substring(0,a))]=A(b.substring(a+1))}return c},Oc=function(c,a,d){var b=oc.exec(B(c,a));if(!b)throw{message:"Invalid HTTP response"};return{statusCode:b[1],statusText:b[2],headers:Gb(c,a),body:D(c,a,d)}},B=function(b,a){return D(b,a,"\r\n")},D=function(c,b,d){var e=b.position||0,a=c.length;if(d){a=c.indexOf(d,e);if(a===-1)return null;b.position=a+d.length}else b.position=a;return c.substring(e,a)},Zc=function(g,f){var h=u(g);if(h!==d.batch)throw{message:'Serialization of batches of type "'+h+'" is not supported'};var b=sb("batch_"),e=g.__batchRequests,c="",a,i;for(a=0,i=e.length;a<i;a++)c+=y(b,false)+wb(e[a],f);c+=y(b,true);var j=f.contentType.properties;j.boundary=b;return c},y=function(b,c){var a="\r\n--"+b;if(c)a+="--";return a+"\r\n"},wb=function(f,e,h){var d=f.__changeRequests,a;if(m(d)){if(h)throw{message:"Not Supported: change set nested in other change set"};var c=sb("changeset_");a="Content-Type: "+t+"; boundary="+c+"\r\n";var b,g;for(b=0,g=d.length;b<g;b++)a+=y(c,false)+wb(d[b],e,true);a+=y(c,true)}else{a="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";vb(f,Fb(e),{metadata:e.metadata});a+=Pc(f)}return a},Pc=function(a){var b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(var c in a.headers)if(a.headers[c])b=b+c+": "+a.headers[c]+"\r\n";b+="\r\n";if(a.body)b+=a.body;return b};c.batchHandler=C(Rc,wc,t,"1.0");c.batchHandler.partHandler=c.defaultHandler;c.read=function(a,g,h,f,d,e){var b;if(a instanceof String||typeof a==="string")b={requestUri:a};else b=a;c.request(b,g,h,f,d,e)};c.request=function(h,f,b,a,d,e){if(!f)f=c.defaultSuccess;if(!b)b=c.defaultError;if(!a)a=c.defaultHandler;if(!d)d=c.defaultHttpClient;if(!e)e=c.defaultMetadata;var g={metadata:e};try{vb(h,a,g);Ic(h,f,b,a,d,g)}catch(i){b(i);return}}})(this)
